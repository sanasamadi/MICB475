library(phyloseq)
library(ape)
library(tidyverse)

#Load data
meta <- read.delim("colombia_metadata.txt")

#Filter data
meta_filtered <- select(meta, c(BMI, waist_circumference, Body_Fat_Percentage))

# Sample data for demonstration purposes
Individuals <- data.frame(meta_filtered)


# Initialize an empty vector to store the filtered indices
filtered_indices <- c()

# Loop through each row of the data frame
for (i in 1:nrow(Individuals)) {
  row <- Individuals[i,]
  
  # Check if the row meets all three thresholds or if it's below all three thresholds
  if ((row$BMI >= 30 & ((row$gender == "male" & row$Body_Fat_Percentage >= 25) | 
                        (row$gender == "female" & row$Body_Fat_Percentage >= 30)) & 
                        row$waist_circumference >= 90) |
      (row$BMI < 30 & ((row$gender == "male" & row$Body_Fat_Fercentage < 25) | 
                       (row$gender == "female" & row$Body_Fat_Percentage < 30)) & 
                       row$waist_circumference < 90)) {
    filtered_indices <- c(filtered_indices, i)
  }
}

# Subset the data frame to include only the filtered rows
filtered_Individuals <- Individuals[filtered_indices,]
